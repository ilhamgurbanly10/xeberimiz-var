// onloading

const loading_ani = document.querySelector('.fl-loading-ani');

document.body.onload = function() {

	document.body.classList.remove('fl-page-is-not-loaded');
	if (loading_ani != undefined) loading_ani.classList.add('fl-stop');

}

// the-end-of-onloading



// using-functions

flashNavbar();

flashNavbarSearch();


// the-end-of-using-functions


// flash-navbar

function flashNavbar() {
	
	// elements-and-values
	const navbar = document.querySelector('.fl-navbar');
	const navbarToggler = document.querySelector('.fl-navbar-toggler');
	const smScreenMenu = document.querySelector('.fl-sm-screen-menu');
	var navDropdownTogglers = navbar.getElementsByClassName('fl-nav-dropdown-toggler');
	var smScreenMenuDropdownTogglers = smScreenMenu.getElementsByClassName('fl-sm-screen-menu-dropdown-toggler');
	var smScreenMenuDropdowns = smScreenMenu.getElementsByClassName('fl-sm-screen-dropdown-menu-con');
	var smScreenMenuOtherLinks = smScreenMenu.querySelectorAll('.fl-sm-screen-menu-link:not(.fl-sm-screen-menu-dropdown-toggler)');
	var isHovered = false;

	// functions
	function preventDefaultLinks() {

		for (var i = 0; i < navDropdownTogglers.length; i++) {

			navDropdownTogglers[i].onclick = function(event) { event.preventDefault(); }
			smScreenMenuDropdownTogglers[i].onclick = function(event) { event.preventDefault(); }

		}

	}

	function toggle() {

		this.classList.toggle('fl-active');
		smScreenMenu.classList.toggle('fl-show');

		if (smScreenMenu.classList.contains('fl-show')) 
			document.documentElement.addEventListener('click', close);
		else 
			document.documentElement.removeEventListener('click', close);

	}

	function toggleDropdown() {

		const dropdown = this.parentElement.querySelector('.fl-sm-screen-dropdown-menu-con');

		dropdown.classList.toggle('fl-show');
		this.classList.toggle('fl-active');

		closeOtherDropdowns(dropdown);

	}	

	function closeOtherDropdowns(dropdown) {

		for (var x = 0; x < smScreenMenuDropdowns.length; x++) {
			
			if (smScreenMenuDropdowns[x] == dropdown) continue;

			smScreenMenuDropdowns[x].classList.remove('fl-show');
			smScreenMenuDropdownTogglers[x].classList.remove('fl-active');

		}

		deactiveOtherLinks();

	}

	function deactiveOtherLinks() { 

		for (var y = 0; y < smScreenMenuOtherLinks.length; y++) {
			smScreenMenuOtherLinks[y].classList.remove('fl-active');
		} 

	}

	function close() {

		if (!isHovered) {

			navbarToggler.classList.remove('fl-active');
			smScreenMenu.classList.remove('fl-show');
			document.documentElement.removeEventListener('click', close);

		}	

	}



	function mouseIsOver() { isHovered = true; }

	function mouseIsOut() { isHovered = false; }

	// adding-functions
	navbarToggler.addEventListener('click', toggle);

	navbarToggler.addEventListener('mouseover', mouseIsOver);
	navbarToggler.addEventListener('mouseout', mouseIsOut);
	smScreenMenu.addEventListener('mouseover', mouseIsOver);
	smScreenMenu.addEventListener('mouseout', mouseIsOut);

	for (var i = 0; i < smScreenMenuDropdownTogglers.length; i++) {

		smScreenMenuDropdownTogglers[i].addEventListener('click', toggleDropdown);

	}

	// using-functions
	preventDefaultLinks();
}



// the-end-of-flash-navbar



// flash-navbar-search

function flashNavbarSearch() {

	// elements-and-values
	const con = document.querySelector('.fl-navbar-search-parent');

	// avoiding-errors
	if (con == undefined) return;

	const form = con.querySelector('.fl-navbar-search');
	const input = form.querySelector('.fl-navbar-search-input');
	const showResults = form.getAttribute('show-results');
	const results = con.querySelector('.fl-navbar-results-of-search');
	const submit = form.querySelector('.fl-navbar-search-submit');
	const reset = form.querySelector('.fl-navbar-search-reset');

	const toggler = document.querySelector('.fl-navbar-search-toggler');
	const icon = toggler.querySelector('.fa');
	var isHovered = false;

	// adding-functions
	if (showResults == "true") { 

		input.addEventListener('keyup', toggle);
		input.addEventListener('focusin', show);
		input.addEventListener('focusout', hide);

	} else {

		input.addEventListener('keyup', enableDisableButtons);
		
	}

	reset.addEventListener('click', disableButtons);
	toggler.addEventListener('click', toggleContainer);
	toggler.addEventListener('mouseover', mouseIsOver);
	toggler.addEventListener('mouseout', mouseIsOut);
	con.addEventListener('mouseover', mouseIsOver);
	con.addEventListener('mouseout', mouseIsOut);
	results.addEventListener('mouseover', mouseIsOver);
	results.addEventListener('mouseout', mouseIsOut);
	
	// functions
	function toggleContainer() {

		if (!con.classList.contains('fl-show'))
			document.documentElement.addEventListener('click', closeContainer);
		else
			document.documentElement.removeEventListener('click', closeContainer);

		this.classList.toggle('fl-active');
		con.classList.toggle('fl-show');
		toggleIcon();

	}



	function closeContainer() {

		if (!isHovered) {

			con.classList.remove('fl-show');
			document.documentElement.removeEventListener('click', closeContainer);

			toggler.classList.remove('fl-active');

			if (icon == undefined) return;

			icon.classList.add('fa-search');
			icon.classList.remove('fa-times');

		}	

	}

	function toggleIcon() {

		if (icon == undefined) return;

		icon.classList.toggle('fa-search');
		icon.classList.toggle('fa-times');

	}

	function mouseIsOver() { isHovered = true; }

	function mouseIsOut() { isHovered = false; }

	function toggle() {

		if (this.value != "") {

			results.classList.add('fl-show');
			enableSubmit();
			enableReset();

		} else { 

			hide();
			disableSubmit();
			disableReset();

		}	

	}

	function show() {

		if (this.value != "") { 

			results.classList.add('fl-show');
			enableSubmit();
			enableReset();

		}	


	}

	function hide() { results.classList.remove('fl-show'); }

	function enableSubmit() { submit.removeAttribute('disabled'); }

	function disableSubmit() { submit.setAttribute('disabled',''); }

	function enableReset() { reset.removeAttribute('disabled'); }

	function disableReset() { reset.setAttribute('disabled',''); }

	function disableButtons() {

		submit.setAttribute('disabled','');
		reset.setAttribute('disabled','');
		input.value = "";

	}

	function enableDisableButtons() {

		if (this.value != "") {

			enableSubmit();
			enableReset();

		} else { 

			disableSubmit();
			disableReset();

		}

	}

}
// flash-navbar-search